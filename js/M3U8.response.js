class e{constructor(){this.name="Lodash",this.version="1.0.0",console.log(`\n${this.name} v${this.version}\n`)}get(e={},a="",t=void 0){Array.isArray(a)||(a=this.toPath(a));const s=a.reduce(((e,a)=>Object(e)[a]),e);return void 0===s?t:s}set(e={},a="",t){return Array.isArray(a)||(a=this.toPath(a)),a.slice(0,-1).reduce(((e,t,s)=>Object(e[t])===e[t]?e[t]:e[t]=/^\d+$/.test(a[s+1])?[]:{}),e)[a[a.length-1]]=t,e}toPath(e){return e.replace(/\[(\d+)\]/g,".$1").split(".").filter(Boolean)}}var a={Switch:!0,Type:"Translate",Types:["Official","Translate"],Languages:["EN","ZH"],CacheSize:50},t={breakLine:{"text/xml":"&#x000A;","application/xml":"&#x000A;","text/vtt":"\n","application/vtt":"\n","text/json":"\n","application/json":"\n"}},s={Settings:a,Configs:t},n={Switch:!0,Types:["Official","Translate"],Languages:["EN","ZH"]},l={Languages:{AUTO:"",AR:["ar","ar-001"],BG:["bg","bg-BG","bul"],CS:["cs","cs-CZ","ces"],DA:["da","da-DK","dan"],DE:["de","de-DE","deu"],EL:["el","el-GR","ell"],EN:["en","en-US","eng","en-GB","en-UK","en-CA","en-US SDH"],"EN-CA":["en-CA","en","eng"],"EN-GB":["en-UK","en","eng"],"EN-US":["en-US","en","eng"],"EN-US SDH":["en-US SDH","en-US","en","eng"],ES:["es","es-419","es-ES","spa","es-419 SDH"],"ES-419":["es-419","es","spa"],"ES-419 SDH":["es-419 SDH","es-419","es","spa"],"ES-ES":["es-ES","es","spa"],ET:["et","et-EE","est"],FI:["fi","fi-FI","fin"],FR:["fr","fr-CA","fr-FR","fra"],"FR-CA":["fr-CA","fr","fra"],"FR-DR":["fr-FR","fr","fra"],HU:["hu","hu-HU","hun"],ID:["id","id-id"],IT:["it","it-IT","ita"],JA:["ja","ja-JP","jpn"],KO:["ko","ko-KR","kor"],LT:["lt","lt-LT","lit"],LV:["lv","lv-LV","lav"],NL:["nl","nl-NL","nld"],NO:["no","nb-NO","nor"],PL:["pl","pl-PL"],PT:["pt","pt-PT","pt-BR","por"],"PT-PT":["pt-PT","pt","por"],"PT-BR":["pt-BR","pt","por"],RO:["ro","ro-RO","ron"],RU:["ru","ru-RU","rus"],SK:["sk","sk-SK","slk"],SL:["sl","sl-SI","slv"],SV:["sv","sv-SE","swe"],IS:["is","is-IS","isl"],ZH:["zh","cmn","zho","zh-CN","zh-Hans","cmn-Hans","zh-TW","zh-Hant","cmn-Hant","zh-HK","yue-Hant","yue"],"ZH-CN":["zh-CN","zh-Hans","cmn-Hans","zho"],"ZH-HANS":["zh-Hans","cmn-Hans","zh-CN","zho"],"ZH-HK":["zh-HK","yue-Hant","yue","zho"],"ZH-TW":["zh-TW","zh-Hant","cmn-Hant","zho"],"ZH-HANT":["zh-Hant","cmn-Hant","zh-TW","zho"],YUE:["yue","yue-Hant","zh-HK","zho"],"YUE-HK":["yue-Hant","yue","zh-HK","zho"]}},g={Settings:n,Configs:l},u={Switch:!0,Type:"Official",Types:["Translate","External"],Languages:["AUTO","ZH"],AutoCC:!0,ShowOnly:!1},o={Languages:{BG:"bg-BG",CS:"cs",DA:"da-DK",DE:"de",EL:"el",EN:"en","EN-GB":"en-GB","EN-US":"en-US","EN-US SDH":"en-US SDH",ES:"es","ES-419":"es-419","ES-ES":"es-ES",ET:"et-EE",FI:"fi",FR:"fr",HU:"hu-HU",ID:"id",IS:"is-IS",IT:"it",JA:"ja",KO:"ko",LT:"lt-LT",LV:"lv-LV",NL:"nl-NL",NO:"nb-NO",PL:"pl-PL",PT:"pt","PT-PT":"pt-PT","PT-BR":"pt-BR",RO:"ro-RO",RU:"ru-RU",SK:"sk-SK",SL:"sl-SI",SV:"sv-SE",YUE:"yue","YUE-HK":"yue-HK",ZH:"zh","ZH-HANS":"zh-Hans","ZH-HK":"zh-Hant-HK","ZH-HANT":"zh-Hant","ZH-TW":"zh-TW"},translationLanguages:{DESKTOP:[{languageCode:"sq",languageName:{simpleText:"Shqip - 阿尔巴尼亚语"}},{languageCode:"ak",languageName:{simpleText:"Ákán - 阿肯语"}},{languageCode:"ar",languageName:{simpleText:"العربية - 阿拉伯语"}},{languageCode:"am",languageName:{simpleText:"አማርኛ - 阿姆哈拉语"}},{languageCode:"as",languageName:{simpleText:"অসমীয়া - 阿萨姆语"}},{languageCode:"az",languageName:{simpleText:"آذربايجان ديلی - 阿塞拜疆语"}},{languageCode:"ee",languageName:{simpleText:"Èʋegbe - 埃维语"}},{languageCode:"ay",languageName:{simpleText:"Aymar aru - 艾马拉语"}},{languageCode:"ga",languageName:{simpleText:"Gaeilge - 爱尔兰语"}},{languageCode:"et",languageName:{simpleText:"Eesti - 爱沙尼亚语"}},{languageCode:"or",languageName:{simpleText:"ଓଡ଼ିଆ - 奥里亚语"}},{languageCode:"om",languageName:{simpleText:"Afaan Oromoo - 奥罗莫语"}},{languageCode:"eu",languageName:{simpleText:"Euskara - 巴斯克语"}},{languageCode:"be",languageName:{simpleText:"Беларуская - 白俄罗斯语"}},{languageCode:"bg",languageName:{simpleText:"Български - 保加利亚语"}},{languageCode:"nso",languageName:{simpleText:"Sesotho sa Leboa - 北索托语"}},{languageCode:"is",languageName:{simpleText:"Íslenska - 冰岛语"}},{languageCode:"pl",languageName:{simpleText:"Polski - 波兰语"}},{languageCode:"bs",languageName:{simpleText:"Bosanski - 波斯尼亚语"}},{languageCode:"fa",languageName:{simpleText:"فارسی - 波斯语"}},{languageCode:"bho",languageName:{simpleText:"भोजपुरी - 博杰普尔语"}},{languageCode:"ts",languageName:{simpleText:"Xitsonga - 聪加语"}},{languageCode:"tt",languageName:{simpleText:"Татарча - 鞑靼语"}},{languageCode:"da",languageName:{simpleText:"Dansk - 丹麦语"}},{languageCode:"de",languageName:{simpleText:"Deutsch - 德语"}},{languageCode:"dv",languageName:{simpleText:"ދިވެހިބަސް - 迪维希语"}},{languageCode:"ru",languageName:{simpleText:"Русский - 俄语"}},{languageCode:"fr",languageName:{simpleText:"français - 法语"}},{languageCode:"sa",languageName:{simpleText:"संस्कृतम् - 梵语"}},{languageCode:"fil",languageName:{simpleText:"Filipino - 菲律宾语"}},{languageCode:"fi",languageName:{simpleText:"suomi - 芬兰语"}},{languageCode:"km",languageName:{simpleText:"ភាសាខ្មែរ - 高棉语"}},{languageCode:"ka",languageName:{simpleText:"ქართული - 格鲁吉亚语"}},{languageCode:"gu",languageName:{simpleText:"ગુજરાતી - 古吉拉特语"}},{languageCode:"gn",languageName:{simpleText:"Avañe'ẽ - 瓜拉尼语"}},{languageCode:"kk",languageName:{simpleText:"Қазақ тілі - 哈萨克语"}},{languageCode:"ht",languageName:{simpleText:"Kreyòl ayisyen - 海地克里奥尔语"}},{languageCode:"ko",languageName:{simpleText:"한국어 - 韩语"}},{languageCode:"ha",languageName:{simpleText:"هَوُسَ - 豪萨语"}},{languageCode:"nl",languageName:{simpleText:"Nederlands - 荷兰语"}},{languageCode:"gl",languageName:{simpleText:"Galego - 加利西亚语"}},{languageCode:"ca",languageName:{simpleText:"català - 加泰罗尼亚语"}},{languageCode:"cs",languageName:{simpleText:"čeština - 捷克语"}},{languageCode:"kn",languageName:{simpleText:"ಕನ್ನಡ - 卡纳达语"}},{languageCode:"ky",languageName:{simpleText:"кыргыз тили - 吉尔吉斯语"}},{languageCode:"xh",languageName:{simpleText:"isiXhosa - 科萨语"}},{languageCode:"co",languageName:{simpleText:"corsu - 科西嘉语"}},{languageCode:"hr",languageName:{simpleText:"hrvatski - 克罗地亚语"}},{languageCode:"qu",languageName:{simpleText:"Runa Simi - 克丘亚语"}},{languageCode:"ku",languageName:{simpleText:"Kurdî - 库尔德语"}},{languageCode:"la",languageName:{simpleText:"lingua latīna - 拉丁语"}},{languageCode:"lv",languageName:{simpleText:"latviešu valoda - 拉脱维亚语"}},{languageCode:"lo",languageName:{simpleText:"ພາສາລາວ - 老挝语"}},{languageCode:"lt",languageName:{simpleText:"lietuvių kalba - 立陶宛语"}},{languageCode:"ln",languageName:{simpleText:"lingála - 林加拉语"}},{languageCode:"lg",languageName:{simpleText:"Luganda - 卢干达语"}},{languageCode:"lb",languageName:{simpleText:"Lëtzebuergesch - 卢森堡语"}},{languageCode:"rw",languageName:{simpleText:"Kinyarwanda - 卢旺达语"}},{languageCode:"ro",languageName:{simpleText:"Română - 罗马尼亚语"}},{languageCode:"mt",languageName:{simpleText:"Malti - 马耳他语"}},{languageCode:"mr",languageName:{simpleText:"मराठी - 马拉地语"}},{languageCode:"mg",languageName:{simpleText:"Malagasy - 马拉加斯语"}},{languageCode:"ml",languageName:{simpleText:"മലയാളം - 马拉雅拉姆语"}},{languageCode:"ms",languageName:{simpleText:"bahasa Melayu - 马来语"}},{languageCode:"mk",languageName:{simpleText:"македонски јазик - 马其顿语"}},{languageCode:"mi",languageName:{simpleText:"te reo Māori - 毛利语"}},{languageCode:"mn",languageName:{simpleText:"Монгол хэл - 蒙古语"}},{languageCode:"bn",languageName:{simpleText:"বাংলা - 孟加拉语"}},{languageCode:"my",languageName:{simpleText:"ဗမာစာ - 缅甸语"}},{languageCode:"hmn",languageName:{simpleText:"Hmoob - 苗语"}},{languageCode:"af",languageName:{simpleText:"Afrikaans - 南非荷兰语"}},{languageCode:"st",languageName:{simpleText:"Sesotho - 南索托语"}},{languageCode:"ne",languageName:{simpleText:"नेपाली - 尼泊尔语"}},{languageCode:"no",languageName:{simpleText:"Norsk - 挪威语"}},{languageCode:"pa",languageName:{simpleText:"ਪੰਜਾਬੀ - 旁遮普语"}},{languageCode:"pt",languageName:{simpleText:"Português - 葡萄牙语"}},{languageCode:"ps",languageName:{simpleText:"پښتو - 普什图语"}},{languageCode:"ny",languageName:{simpleText:"chiCheŵa - 齐切瓦语"}},{languageCode:"ja",languageName:{simpleText:"日本語 - 日语"}},{languageCode:"sv",languageName:{simpleText:"Svenska - 瑞典语"}},{languageCode:"sm",languageName:{simpleText:"Gagana fa'a Samoa - 萨摩亚语"}},{languageCode:"sr",languageName:{simpleText:"Српски језик - 塞尔维亚语"}},{languageCode:"si",languageName:{simpleText:"සිංහල - 僧伽罗语"}},{languageCode:"sn",languageName:{simpleText:"ChiShona - 绍纳语"}},{languageCode:"eo",languageName:{simpleText:"Esperanto - 世界语"}},{languageCode:"sk",languageName:{simpleText:"slovenčina - 斯洛伐克语"}},{languageCode:"sl",languageName:{simpleText:"slovenščina - 斯洛文尼亚语"}},{languageCode:"sw",languageName:{simpleText:"Kiswahili - 斯瓦希里语"}},{languageCode:"gd",languageName:{simpleText:"Gàidhlig - 苏格兰盖尔语"}},{languageCode:"ceb",languageName:{simpleText:"Binisaya - 宿务语"}},{languageCode:"so",languageName:{simpleText:"Soomaaliga - 索马里语"}},{languageCode:"tg",languageName:{simpleText:"тоҷикӣ - 塔吉克语"}},{languageCode:"te",languageName:{simpleText:"తెలుగు - 泰卢固语"}},{languageCode:"ta",languageName:{simpleText:"தமிழ் - 泰米尔语"}},{languageCode:"th",languageName:{simpleText:"ไทย - 泰语"}},{languageCode:"ti",languageName:{simpleText:"ትግርኛ - 提格利尼亚语"}},{languageCode:"tr",languageName:{simpleText:"Türkçe - 土耳其语"}},{languageCode:"tk",languageName:{simpleText:"Türkmen - 土库曼语"}},{languageCode:"cy",languageName:{simpleText:"Cymraeg - 威尔士语"}},{languageCode:"ug",languageName:{simpleText:"ئۇيغۇرچە - 维吾尔语"}},{languageCode:"und",languageName:{simpleText:"Unknown - 未知语言"}},{languageCode:"ur",languageName:{simpleText:"اردو - 乌尔都语"}},{languageCode:"uk",languageName:{simpleText:"українська - 乌克兰语"}},{languageCode:"uz",languageName:{simpleText:"O'zbek - 乌兹别克语"}},{languageCode:"es",languageName:{simpleText:"Español - 西班牙语"}},{languageCode:"fy",languageName:{simpleText:"Frysk - 西弗里西亚语"}},{languageCode:"iw",languageName:{simpleText:"עברית - 希伯来语"}},{languageCode:"el",languageName:{simpleText:"Ελληνικά - 希腊语"}},{languageCode:"haw",languageName:{simpleText:"ʻŌlelo Hawaiʻi - 夏威夷语"}},{languageCode:"sd",languageName:{simpleText:"سنڌي - 信德语"}},{languageCode:"hu",languageName:{simpleText:"magyar - 匈牙利语"}},{languageCode:"su",languageName:{simpleText:"Basa Sunda - 巽他语"}},{languageCode:"hy",languageName:{simpleText:"հայերեն - 亚美尼亚语"}},{languageCode:"ig",languageName:{simpleText:"Igbo - 伊博语"}},{languageCode:"it",languageName:{simpleText:"Italiano - 意大利语"}},{languageCode:"yi",languageName:{simpleText:"ייִדיש - 意第绪语"}},{languageCode:"hi",languageName:{simpleText:"हिन्दी - 印地语"}},{languageCode:"id",languageName:{simpleText:"Bahasa Indonesia - 印度尼西亚语"}},{languageCode:"en",languageName:{simpleText:"English - 英语"}},{languageCode:"yo",languageName:{simpleText:"Yorùbá - 约鲁巴语"}},{languageCode:"vi",languageName:{simpleText:"Tiếng Việt - 越南语"}},{languageCode:"jv",languageName:{simpleText:"Basa Jawa - 爪哇语"}},{languageCode:"zh-Hant",languageName:{simpleText:"中文（繁體）- 中文（繁体）"}},{languageCode:"zh-Hans",languageName:{simpleText:"中文（简体）"}},{languageCode:"zu",languageName:{simpleText:"isiZulu - 祖鲁语"}},{languageCode:"kri",languageName:{simpleText:"Krìì - 克里语"}}],MOBILE:[{languageCode:"sq",languageName:{runs:[{text:"Shqip - 阿尔巴尼亚语"}]}},{languageCode:"ak",languageName:{runs:[{text:"Ákán - 阿肯语"}]}},{languageCode:"ar",languageName:{runs:[{text:"العربية - 阿拉伯语"}]}},{languageCode:"am",languageName:{runs:[{text:"አማርኛ - 阿姆哈拉语"}]}},{languageCode:"as",languageName:{runs:[{text:"অসমীয়া - 阿萨姆语"}]}},{languageCode:"az",languageName:{runs:[{text:"Azərbaycanca - 阿塞拜疆语"}]}},{languageCode:"ee",languageName:{runs:[{text:"Eʋegbe - 埃维语"}]}},{languageCode:"ay",languageName:{runs:[{text:"Aymar - 艾马拉语"}]}},{languageCode:"ga",languageName:{runs:[{text:"Gaeilge - 爱尔兰语"}]}},{languageCode:"et",languageName:{runs:[{text:"Eesti - 爱沙尼亚语"}]}},{languageCode:"or",languageName:{runs:[{text:"ଓଡ଼ିଆ - 奥里亚语"}]}},{languageCode:"om",languageName:{runs:[{text:"Oromoo - 奥罗莫语"}]}},{languageCode:"eu",languageName:{runs:[{text:"Euskara - 巴斯克语"}]}},{languageCode:"be",languageName:{runs:[{text:"Беларуская - 白俄罗斯语"}]}},{languageCode:"bg",languageName:{runs:[{text:"Български - 保加利亚语"}]}},{languageCode:"nso",languageName:{runs:[{text:"Sesotho sa Leboa - 北索托语"}]}},{languageCode:"is",languageName:{runs:[{text:"Íslenska - 冰岛语"}]}},{languageCode:"pl",languageName:{runs:[{text:"Polski - 波兰语"}]}},{languageCode:"bs",languageName:{runs:[{text:"Bosanski - 波斯尼亚语"}]}},{languageCode:"fa",languageName:{runs:[{text:"فارسی - 波斯语"}]}},{languageCode:"bho",languageName:{runs:[{text:"भोजपुरी - 博杰普尔语"}]}},{languageCode:"ts",languageName:{runs:[{text:"Xitsonga - 聪加语"}]}},{languageCode:"tt",languageName:{runs:[{text:"Татарча - 鞑靼语"}]}},{languageCode:"da",languageName:{runs:[{text:"Dansk - 丹麦语"}]}},{languageCode:"de",languageName:{runs:[{text:"Deutsch - 德语"}]}},{languageCode:"dv",languageName:{runs:[{text:"ދިވެހިބަސް - 迪维希语"}]}},{languageCode:"ru",languageName:{runs:[{text:"Русский - 俄语"}]}},{languageCode:"fr",languageName:{runs:[{text:"Français - 法语"}]}},{languageCode:"sa",languageName:{runs:[{text:"संस्कृतम् - 梵语"}]}},{languageCode:"fil",languageName:{runs:[{text:"Filipino - 菲律宾语"}]}},{languageCode:"fi",languageName:{runs:[{text:"Suomi - 芬兰语"}]}},{languageCode:"km",languageName:{runs:[{text:"ភាសាខ្មែរ - 高棉语"}]}},{languageCode:"ka",languageName:{runs:[{text:"ქართული - 格鲁吉亚语"}]}},{languageCode:"gu",languageName:{runs:[{text:"ગુજરાતી - 古吉拉特语"}]}},{languageCode:"gn",languageName:{runs:[{text:"Avañe'ẽ - 瓜拉尼语"}]}},{languageCode:"kk",languageName:{runs:[{text:"Қазақ тілі - 哈萨克语"}]}},{languageCode:"ht",languageName:{runs:[{text:"海地克里奥尔语"}]}},{languageCode:"ko",languageName:{runs:[{text:"한국말 - 韩语"}]}},{languageCode:"ha",languageName:{runs:[{text:"هَوُسَ - 豪萨语"}]}},{languageCode:"nl",languageName:{runs:[{text:"Nederlands - 荷兰语"}]}},{languageCode:"gl",languageName:{runs:[{text:"Galego - 加利西亚语"}]}},{languageCode:"ca",languageName:{runs:[{text:"Català - 加泰罗尼亚语"}]}},{languageCode:"cs",languageName:{runs:[{text:"Čeština - 捷克语"}]}},{languageCode:"kn",languageName:{runs:[{text:"ಕನ್ನಡ - 卡纳达语"}]}},{languageCode:"ky",languageName:{runs:[{text:"Кыргызча - 吉尔吉斯语"}]}},{languageCode:"xh",languageName:{runs:[{text:"isiXhosa - 科萨语"}]}},{languageCode:"co",languageName:{runs:[{text:"Corsu - 科西嘉语"}]}},{languageCode:"hr",languageName:{runs:[{text:"Hrvatski - 克罗地亚语"}]}},{languageCode:"qu",languageName:{runs:[{text:"Runa Simi - 克丘亚语"}]}},{languageCode:"ku",languageName:{runs:[{text:"Kurdî - 库尔德语"}]}},{languageCode:"la",languageName:{runs:[{text:"lingua latīna - 拉丁语"}]}},{languageCode:"lv",languageName:{runs:[{text:"Latviešu - 拉脱维亚语"}]}},{languageCode:"lo",languageName:{runs:[{text:"ລາວ - 老挝语"}]}},{languageCode:"lt",languageName:{runs:[{text:"Lietuvių - 立陶宛语"}]}},{languageCode:"ln",languageName:{runs:[{text:"Lingála - 林加拉语"}]}},{languageCode:"lg",languageName:{runs:[{text:"Luganda - 卢干达语"}]}},{languageCode:"lb",languageName:{runs:[{text:"Lëtzebuergesch - 卢森堡语"}]}},{languageCode:"rw",languageName:{runs:[{text:"Kinyarwanda - 卢旺达语"}]}},{languageCode:"ro",languageName:{runs:[{text:"Română - 罗马尼亚语"}]}},{languageCode:"mt",languageName:{runs:[{text:"Malti - 马耳他语"}]}},{languageCode:"mr",languageName:{runs:[{text:"मराठी - 马拉地语"}]}},{languageCode:"mg",languageName:{runs:[{text:"Malagasy - 马拉加斯语"}]}},{languageCode:"ml",languageName:{runs:[{text:"മലയാളം - 马拉雅拉姆语"}]}},{languageCode:"ms",languageName:{runs:[{text:"Bahasa Melayu - 马来语"}]}},{languageCode:"mk",languageName:{runs:[{text:"македонски - 马其顿语"}]}},{languageCode:"mi",languageName:{runs:[{text:"Māori - 毛利语"}]}},{languageCode:"mn",languageName:{runs:[{text:"Монгол - 蒙古语"}]}},{languageCode:"bn",languageName:{runs:[{text:"বাংলা - 孟加拉语"}]}},{languageCode:"my",languageName:{runs:[{text:"ဗမာစာ - 缅甸语"}]}},{languageCode:"hmn",languageName:{runs:[{text:"Hmoob - 苗语"}]}},{languageCode:"af",languageName:{runs:[{text:"Afrikaans - 南非荷兰语"}]}},{languageCode:"st",languageName:{runs:[{text:"Sesotho - 南索托语"}]}},{languageCode:"ne",languageName:{runs:[{text:"नेपाली - 尼泊尔语"}]}},{languageCode:"no",languageName:{runs:[{text:"Norsk - 挪威语"}]}},{languageCode:"pa",languageName:{runs:[{text:"ਪੰਜਾਬੀ - 旁遮普语"}]}},{languageCode:"pt",languageName:{runs:[{text:"Português - 葡萄牙语"}]}},{languageCode:"ps",languageName:{runs:[{text:"پښتو - 普什图语"}]}},{languageCode:"ny",languageName:{runs:[{text:"chiCheŵa - 齐切瓦语"}]}},{languageCode:"ja",languageName:{runs:[{text:"日本語 - 日语"}]}},{languageCode:"sv",languageName:{runs:[{text:"Svenska - 瑞典语"}]}},{languageCode:"sm",languageName:{runs:[{text:"Gagana Samoa - 萨摩亚语"}]}},{languageCode:"sr",languageName:{runs:[{text:"Српски језик - 塞尔维亚语"}]}},{languageCode:"si",languageName:{runs:[{text:"සිංහල - 僧伽罗语"}]}},{languageCode:"sn",languageName:{runs:[{text:"ChiShona - 绍纳语"}]}},{languageCode:"eo",languageName:{runs:[{text:"Esperanto - 世界语"}]}},{languageCode:"sk",languageName:{runs:[{text:"Slovenčina - 斯洛伐克语"}]}},{languageCode:"sl",languageName:{runs:[{text:"Slovenščina - 斯洛文尼亚语"}]}},{languageCode:"sw",languageName:{runs:[{text:"Kiswahili - 斯瓦希里语"}]}},{languageCode:"gd",languageName:{runs:[{text:"Gàidhlig - 苏格兰盖尔语"}]}},{languageCode:"ceb",languageName:{runs:[{text:"Cebuano - 宿务语"}]}},{languageCode:"so",languageName:{runs:[{text:"Soomaaliga - 索马里语"}]}},{languageCode:"tg",languageName:{runs:[{text:"тоҷикӣ - 塔吉克语"}]}},{languageCode:"te",languageName:{runs:[{text:"తెలుగు - 泰卢固语"}]}},{languageCode:"ta",languageName:{runs:[{text:"தமிழ் - 泰米尔语"}]}},{languageCode:"th",languageName:{runs:[{text:"ไทย - 泰语"}]}},{languageCode:"ti",languageName:{runs:[{text:"ትግርኛ - 提格利尼亚语"}]}},{languageCode:"tr",languageName:{runs:[{text:"Türkçe - 土耳其语"}]}},{languageCode:"tk",languageName:{runs:[{text:"Türkmen - 土库曼语"}]}},{languageCode:"cy",languageName:{runs:[{text:"Cymraeg - 威尔士语"}]}},{languageCode:"ug",languageName:{runs:[{text:"ئۇيغۇرچە - 维吾尔语"}]}},{languageCode:"und",languageName:{runs:[{text:"Unknown - 未知语言"}]}},{languageCode:"ur",languageName:{runs:[{text:"اردو - 乌尔都语"}]}},{languageCode:"uk",languageName:{runs:[{text:"Українська - 乌克兰语"}]}},{languageCode:"uz",languageName:{runs:[{text:"O‘zbek - 乌兹别克语"}]}},{languageCode:"es",languageName:{runs:[{text:"Español - 西班牙语"}]}},{languageCode:"fy",languageName:{runs:[{text:"Frysk - 西弗里西亚语"}]}},{languageCode:"iw",languageName:{runs:[{text:"עברית - 希伯来语"}]}},{languageCode:"el",languageName:{runs:[{text:"Ελληνικά - 希腊语"}]}},{languageCode:"haw",languageName:{runs:[{text:"ʻŌlelo Hawaiʻi - 夏威夷语"}]}},{languageCode:"sd",languageName:{runs:[{text:"سنڌي - 信德语"}]}},{languageCode:"hu",languageName:{runs:[{text:"Magyar - 匈牙利语"}]}},{languageCode:"su",languageName:{runs:[{text:"Basa Sunda - 巽他语"}]}},{languageCode:"hy",languageName:{runs:[{text:"Հայերեն - 亚美尼亚语"}]}},{languageCode:"ig",languageName:{runs:[{text:"Igbo - 伊博语"}]}},{languageCode:"it",languageName:{runs:[{text:"Italiano - 意大利语"}]}},{languageCode:"yi",languageName:{runs:[{text:"ייִדיש - 意第绪语"}]}},{languageCode:"hi",languageName:{runs:[{text:"हिन्दी - 印地语"}]}},{languageCode:"id",languageName:{runs:[{text:"Bahasa Indonesia - 印度尼西亚语"}]}},{languageCode:"en",languageName:{runs:[{text:"English - 英语"}]}},{languageCode:"yo",languageName:{runs:[{text:"Yorùbá - 约鲁巴语"}]}},{languageCode:"vi",languageName:{runs:[{text:"Tiếng Việt - 越南语"}]}},{languageCode:"jv",languageName:{runs:[{text:"Basa Jawa - 爪哇语"}]}},{languageCode:"zh-Hant",languageName:{runs:[{text:"中文（繁體） - 中文（繁体）"}]}},{languageCode:"zh-Hans",languageName:{runs:[{text:"中文（简体）"}]}},{languageCode:"zu",languageName:{runs:[{text:"isiZulu - 祖鲁语"}]}},{languageCode:"kri",languageName:{runs:[{text:"Krìì - 克里语"}]}}]}},i={Settings:u,Configs:o},r={Switch:!0,Type:"Translate",Languages:["AUTO","ZH"]},d={Languages:{AR:"ar",CS:"cs",DA:"da",DE:"de",EN:"en","EN-GB":"en-GB","EN-US":"en-US","EN-US SDH":"en-US SDH",ES:"es","ES-419":"es-419","ES-ES":"es-ES",FI:"fi",FR:"fr",HE:"he",HR:"hr",HU:"hu",ID:"id",IT:"it",JA:"ja",KO:"ko",MS:"ms",NB:"nb",NL:"nl",PL:"pl",PT:"pt","PT-PT":"pt-PT","PT-BR":"pt-BR",RO:"ro",RU:"ru",SV:"sv",TH:"th",TR:"tr",UK:"uk",VI:"vi",IS:"is",ZH:"zh","ZH-HANS":"zh-Hans","ZH-HK":"zh-HK","ZH-HANT":"zh-Hant"}},m={Settings:r,Configs:d},c={Switch:!0,Types:["Translate","External"],Languages:["AUTO","ZH"]},h={Settings:c},p={CacheSize:20,ShowOnly:!1,Position:"Reverse",Offset:0,Tolerance:1e3},N={Settings:p},C={Vendor:"Google",ShowOnly:!1,Position:"Forward",CacheSize:10,Method:"Part",Times:3,Interval:500,Exponential:!0},T={Settings:C},x={SubVendor:"URL",LrcVendor:"NeteaseMusic",CacheSize:50},f={Settings:x},y={GoogleCloud:{Version:"v2",Mode:"Key",Auth:""},Microsoft:{Version:"Azure",Mode:"Token",Region:"",Auth:""},DeepL:{Version:"Free",Auth:""},DeepLX:{Endpoint:"",Auth:""},URL:"",NeteaseMusic:{PhoneNumber:"",Password:""}},S={Settings:y},b=Database={Default:Object.freeze({__proto__:null,Configs:t,Settings:a,default:s}),Universal:Object.freeze({__proto__:null,Configs:l,Settings:n,default:g}),YouTube:Object.freeze({__proto__:null,Configs:o,Settings:u,default:i}),Netflix:Object.freeze({__proto__:null,Configs:d,Settings:r,default:m}),Spotify:Object.freeze({__proto__:null,Settings:c,default:h}),Composite:Object.freeze({__proto__:null,Settings:p,default:N}),Translate:Object.freeze({__proto__:null,Settings:C,default:T}),External:Object.freeze({__proto__:null,Settings:x,default:f}),API:Object.freeze({__proto__:null,Settings:y,default:S})};function O(e,a=100){return console.log(`☑️ Set Cache, cacheSize: ${a}`,""),e=(e=Array.from(e||[])).slice(-a),console.log("✅ Set Cache",""),e}function P(e={},a={},t="",s="",n=!0,l="iPhone"){console.log(`☑️ Set DualSubs Subtitle Option, type: ${t}`,"");const g=e?.OPTION?.NAME.trim(),u=a?.OPTION?.NAME.trim(),o=e?.OPTION?.LANGUAGE.trim(),i=a?.OPTION?.LANGUAGE.trim();let r=JSON.parse(JSON.stringify(e));switch(t){case"Official":r.OPTION.NAME=`官方字幕 (${g}/${u})`;break;case"Translate":r.OPTION.NAME=`翻译字幕 (${g}/${u})`;break;case"External":r.OPTION.NAME=`外挂字幕 (${g})`}switch(s){case"Apple":case"MGM+":switch(l){case"Web":case"Macintosh":r.OPTION.LANGUAGE=o;break;default:r.OPTION.LANGUAGE=`${t} (${o}/${i})`}break;case"Disney+":case"PrimeVideo":case"Hulu":case"Nebula":case"PlutoTV":case"Paramount+":case"Discovery+Ph":r.OPTION.LANGUAGE=`${t} (${o}/${i})`;break;case"Max":case"HBOMax":case"Viki":default:r.OPTION.LANGUAGE=o;break;case"MUBI":r.OPTION.LANGUAGE=`${t} (${o}/${i})`,n||(r.OPTION.NAME=g)}r.OPTION["ASSOC-LANGUAGE"]=i;const d=r.OPTION.URI.includes("?")?"&":"?";return r.OPTION.URI+=`${d}subtype=${t}`,r.OPTION.AUTOSELECT="YES",n||(r.OPTION.DEFAULT="YES"),console.log(`✅ Set DualSubs Subtitle Option, newOption: ${JSON.stringify(r)}`,""),r}const E=new class{constructor(a,t){this.name=a,this.version="1.4.0",this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,t),this.log("","🚩 开始!",`ENV v${this.version}`,""),this.lodash=new e(this.name),this.log("",this.name,"")}platform(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.platform()}isQuanX(){return"Quantumult X"===this.platform()}isSurge(){return"Surge"===this.platform()}isLoon(){return"Loon"===this.platform()}isShadowrocket(){return"Shadowrocket"===this.platform()}isStash(){return"Stash"===this.platform()}toObj(e,a=null){try{return JSON.parse(e)}catch{return a}}toStr(e,a=null){try{return JSON.stringify(e)}catch{return a}}getjson(e,a){let t=a;if(this.getdata(e))try{t=JSON.parse(this.getdata(e))}catch{}return t}setjson(e,a){try{return this.setdata(JSON.stringify(e),a)}catch{return!1}}getScript(e){return new Promise((a=>{this.get({url:e},((e,t,s)=>a(s)))}))}runScript(e,a){return new Promise((t=>{let s=this.getdata("@chavy_boxjs_userCfgs.httpapi");s=s?s.replace(/\n/g,"").trim():s;let n=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");n=n?1*n:20,n=a&&a.timeout?a.timeout:n;const[l,g]=s.split("@"),u={url:`http://${g}/v1/scripting/evaluate`,body:{script_text:e,mock_type:"cron",timeout:n},headers:{"X-Key":l,Accept:"*/*"},timeout:n};this.post(u,((e,a,s)=>t(s)))})).catch((e=>this.logErr(e)))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),a=this.path.resolve(process.cwd(),this.dataFile),t=this.fs.existsSync(e),s=!t&&this.fs.existsSync(a);if(!t&&!s)return{};{const s=t?e:a;try{return JSON.parse(this.fs.readFileSync(s))}catch(e){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),a=this.path.resolve(process.cwd(),this.dataFile),t=this.fs.existsSync(e),s=!t&&this.fs.existsSync(a),n=JSON.stringify(this.data);t?this.fs.writeFileSync(e,n):s?this.fs.writeFileSync(a,n):this.fs.writeFileSync(e,n)}}getdata(e){let a=this.getval(e);if(/^@/.test(e)){const[,t,s]=/^@(.*?)\.(.*?)$/.exec(e),n=t?this.getval(t):"";if(n)try{const e=JSON.parse(n);a=e?this.lodash.get(e,s,""):a}catch(e){a=""}}return a}setdata(e,a){let t=!1;if(/^@/.test(a)){const[,s,n]=/^@(.*?)\.(.*?)$/.exec(a),l=this.getval(s),g=s?"null"===l?null:l||"{}":"{}";try{const a=JSON.parse(g);this.lodash.set(a,n,e),t=this.setval(JSON.stringify(a),s)}catch(a){const l={};this.lodash.set(l,n,e),t=this.setval(JSON.stringify(l),s)}}else t=this.setval(e,a);return t}getval(e){switch(this.platform()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(e);case"Quantumult X":return $prefs.valueForKey(e);case"Node.js":return this.data=this.loaddata(),this.data[e];default:return this.data&&this.data[e]||null}}setval(e,a){switch(this.platform()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(e,a);case"Quantumult X":return $prefs.setValueForKey(e,a);case"Node.js":return this.data=this.loaddata(),this.data[a]=e,this.writedata(),!0;default:return this.data&&this.data[a]||null}}initGotEnv(e){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,e&&(e.headers=e.headers?e.headers:{},void 0===e.headers.Cookie&&void 0===e.cookieJar&&(e.cookieJar=this.ckjar))}async fetch(e={}||"",a={}){switch(e.constructor){case Object:e={...e,...a};break;case String:e={url:e,...a}}e.method||(e.method="GET",(e.body??e.bodyBytes)&&(e.method="POST")),delete e.headers?.["Content-Length"],delete e.headers?.["content-length"];const t=e.method.toLocaleLowerCase();switch(this.platform()){case"Loon":case"Surge":case"Stash":case"Shadowrocket":default:return delete e.id,e.policy&&(this.isLoon()&&(e.node=e.policy),this.isStash()&&this.lodash.set(e,"headers.X-Stash-Selected-Proxy",encodeURI(e.policy))),ArrayBuffer.isView(e.body)&&(e["binary-mode"]=!0),await new Promise(((a,s)=>{$httpClient[t](e,((t,n,l)=>{t?s(t):(n.ok=/^2\d\d$/.test(n.status),n.statusCode=n.status,l&&(n.body=l,1==e["binary-mode"]&&(n.bodyBytes=l)),a(n))}))}));case"Quantumult X":switch(delete e.scheme,delete e.sessionIndex,delete e.charset,e.policy&&this.lodash.set(e,"opts.policy",e.policy),(e?.headers?.["Content-Type"]??e?.headers?.["content-type"])?.split(";")?.[0]){default:delete e.bodyBytes;break;case"application/protobuf":case"application/x-protobuf":case"application/vnd.google.protobuf":case"application/grpc":case"application/grpc+proto":case"application/octet-stream":delete e.body,ArrayBuffer.isView(e.bodyBytes)&&(e.bodyBytes=e.bodyBytes.buffer.slice(e.bodyBytes.byteOffset,e.bodyBytes.byteLength+e.bodyBytes.byteOffset));case void 0:}return await $task.fetch(e).then((e=>(e.ok=/^2\d\d$/.test(e.statusCode),e.status=e.statusCode,e)),(e=>Promise.reject(e.error)));case"Node.js":let a=require("iconv-lite");this.initGotEnv(e);const{url:s,...n}=e;return await this.got[t](s,n).on("redirect",((e,a)=>{try{if(e.headers["set-cookie"]){const t=e.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();t&&this.ckjar.setCookieSync(t,null),a.cookieJar=this.ckjar}}catch(e){this.logErr(e)}})).then((e=>(e.statusCode=e.status,e.body=a.decode(e.rawBody,this.encoding),e.bodyBytes=e.rawBody,e)),(e=>Promise.reject(e.message)))}}time(e,a=null){const t=a?new Date(a):new Date;let s={"M+":t.getMonth()+1,"d+":t.getDate(),"H+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(let a in s)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?s[a]:("00"+s[a]).substr((""+s[a]).length)));return e}msg(e=name,a="",t="",s){const n=e=>{switch(typeof e){case void 0:return e;case"string":switch(this.platform()){case"Surge":case"Stash":default:return{url:e};case"Loon":case"Shadowrocket":return e;case"Quantumult X":return{"open-url":e};case"Node.js":return}case"object":switch(this.platform()){case"Surge":case"Stash":case"Shadowrocket":default:return{url:e.url||e.openUrl||e["open-url"]};case"Loon":return{openUrl:e.openUrl||e.url||e["open-url"],mediaUrl:e.mediaUrl||e["media-url"]};case"Quantumult X":return{"open-url":e["open-url"]||e.url||e.openUrl,"media-url":e["media-url"]||e.mediaUrl,"update-pasteboard":e["update-pasteboard"]||e.updatePasteboard};case"Node.js":return}default:return}};if(!this.isMute)switch(this.platform()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(e,a,t,n(s));break;case"Quantumult X":$notify(e,a,t,n(s));case"Node.js":}if(!this.isMuteLog){let s=["","==============📣系统通知📣=============="];s.push(e),a&&s.push(a),t&&s.push(t),console.log(s.join("\n")),this.logs=this.logs.concat(s)}}log(...e){e.length>0&&(this.logs=[...this.logs,...e]),console.log(e.join(this.logSeparator))}logErr(e){switch(this.platform()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️ ${this.name}, 错误!`,e);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,e.stack)}}wait(e){return new Promise((a=>setTimeout(a,e)))}done(e={}){const a=((new Date).getTime()-this.startTime)/1e3;switch(this.log("",`🚩 ${this.name}, 结束! 🕛 ${a} 秒`),this.log(),this.platform()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(e);break;case"Node.js":process.exit(1)}}getENV(e,a,t){let s=this.getjson(e,t),n={};if("undefined"!=typeof $argument&&Boolean($argument)){let e=Object.fromEntries($argument.split("&").map((e=>e.split("=").map((e=>e.replace(/\"/g,""))))));for(let a in e)this.lodash.set(n,a,e[a])}const l={Settings:t?.Default?.Settings||{},Configs:t?.Default?.Configs||{},Caches:{}};Array.isArray(a)||(a=[a]);for(let e of a)l.Settings={...l.Settings,...t?.[e]?.Settings,...n,...s?.[e]?.Settings},l.Configs={...l.Configs,...t?.[e]?.Configs},s?.[e]?.Caches&&"string"==typeof s?.[e]?.Caches&&(s[e].Caches=JSON.parse(s?.[e]?.Caches)),l.Caches={...l.Caches,...s?.[e]?.Caches};return this.traverseObject(l.Settings,((e,a)=>("true"===a||"false"===a?a=JSON.parse(a):"string"==typeof a&&(a=a.includes(",")?a.split(",").map((e=>this.string2number(e))):this.string2number(a)),a))),l}traverseObject(e,a){for(var t in e){var s=e[t];e[t]="object"==typeof s&&null!==s?this.traverseObject(s,a):a(t,s)}return e}string2number(e){return e&&!isNaN(e)&&(e=parseInt(e,10)),e}}("🍿️ DualSubs: 🎦 Universal v1.0.0(7) M3U8.response"),k=new class{constructor(e=[]){this.name="URI v1.2.6",this.opts=e,this.json={scheme:"",host:"",path:"",query:{}}}parse(e){let a=e.match(/(?:(?<scheme>.+):\/\/(?<host>[^/]+))?\/?(?<path>[^?]+)?\??(?<query>[^?]+)?/)?.groups??null;if(a?.path?a.paths=a.path.split("/"):a.path="",a?.paths){const e=a.paths[a.paths.length-1];if(e?.includes(".")){const t=e.split(".");a.format=t[t.length-1]}}return a?.query&&(a.query=Object.fromEntries(a.query.split("&").map((e=>e.split("="))))),a}stringify(e=this.json){let a="";return e?.scheme&&e?.host&&(a+=e.scheme+"://"+e.host),e?.path&&(a+=e?.host?"/"+e.path:e.path),e?.query&&(a+="?"+Object.entries(e.query).map((e=>e.join("="))).join("&")),a}},A=new class{constructor(e){this.name="EXTM3U v0.8.6",this.opts=e,this.newLine=this.opts.includes("\n")?"\n":this.opts.includes("\r")?"\r":this.opts.includes("\r\n")?"\r\n":"\n"}parse(e=new String){return[...e.matchAll(/^(?:(?<TAG>#(?:EXT|AIV)[^#:\s\r\n]+)(?::(?<OPTION>[^\r\n]+))?(?:(?:\r\n|\r|\n)(?<URI>[^#\s\r\n]+))?|(?<NOTE>#[^\r\n]+)?)(?:\r\n|\r|\n)?$/gm)].map((e=>(e=e?.groups||e,/=/.test(e?.OPTION)&&(e.OPTION=Object.fromEntries(`${e.OPTION},`.split(/,\s*(?![^"]*",)/).slice(0,-1).map((e=>((e=e.split(/=(.*)/))[1]=isNaN(e[1])?e[1].replace(/^"(.*)"$/,"$1"):parseInt(e[1],10),e))))),e)))}stringify(e=new Array){"#EXTM3U"!==e?.[0]?.TAG&&e.unshift({TAG:"#EXTM3U"});const a=/^((-?\d+[x.\d]+)|[0-9A-Z-]+)$/;return e.map((e=>("object"==typeof e?.OPTION&&(e.OPTION=Object.entries(e.OPTION).map((t=>("#EXT-X-SESSION-DATA"===e?.TAG?t[1]=`"${t[1]}"`:isNaN(t[1])?"ID"===t[0]||"INSTREAM-ID"===t[0]||"KEYFORMAT"===t[0]?t[1]=`"${t[1]}"`:a.test(t[1])||(t[1]=`"${t[1]}"`):t[1]="number"==typeof t[1]?t[1]:`"${t[1]}"`,t.join("=")))).join(",")),e=e?.URI?e.TAG+":"+e.OPTION+this.newLine+e.URI:e?.OPTION?e.TAG+":"+e.OPTION:e?.TAG?e.TAG:e?.NOTE?e.NOTE:""))).join(this.newLine)}}(["\n"]),$=k.parse($request.url);E.log(`⚠ URL: ${JSON.stringify($)}`,"");const w=$request.method;$.host,$.path,$.paths,E.log(`⚠ METHOD: ${w}`,"");const v=($response.headers?.["Content-Type"]??$response.headers?.["content-type"])?.split(";")?.[0];function I(e="",a={},t="",s=[]){E.log("☑️ Get Attribute List",`langCodes: ${s}`,"");let n=a.filter((e=>"#EXT-X-MEDIA"===e?.TAG)).filter((e=>e?.OPTION?.TYPE===t)).filter((e=>"YES"!==e?.OPTION?.FORCED)),l=[];for(let e of s)if(E.log("🚧 Get Attribute List","for (let langcode of langcodes)",`langcode: ${e}`,""),l=n.filter((a=>a?.OPTION?.LANGUAGE?.toLowerCase()===e?.toLowerCase())),0!==l.length)break;return l=l.map((a=>(a.URL=H(e,a?.OPTION?.URI??null),a))),E.log("✅ Get Attribute List",`matchList: ${JSON.stringify(l)}`,""),l}function U(e,a,t){E.log(`☑️ getPlaylistCache, language: ${t}`,"");let s="",n={},l=0;return a?.forEach(((a,g)=>{if(Array.isArray(a?.[t])){let u=a?.[t];u?.some(((a,t)=>!!e.includes(a?.URI??a?.OPTION?.URI??null)&&(l=t,E.log("🚧 getPlaylistCache",`subtitlesPlaylistIndex: ${l}`,""),!0)))&&(s=g,n=a)}})),E.log("✅ getPlaylistCache",`masterPlaylistURL: ${JSON.stringify(s)}`,""),{masterPlaylistURL:s,subtitlesPlaylist:n,subtitlesPlaylistIndex:l}}async function L(e,a,t,s=0,n="Universal"){return E.log(`☑️ setSubtitlesCache, language: ${t}, index: ${s}`,""),await Promise.all(a?.[t]?.map((async(a,t,l)=>{if(l[s]&&t===s||!l[s]){let t=e.get(a.URL)??[];0===t.length&&(t=await async function(e,a,t){E.log("☑️ Get Subtitle *.vtt *.ttml URLs","");let s=await E.fetch(e,{headers:a}).then(((a,t)=>A.parse(a.body).filter((({URI:e})=>/^.+\.((web)?vtt|ttml2?|xml|smi)(\?.+)?$/.test(e))).filter((({URI:e})=>!e.includes("empty"))).filter((({URI:e})=>!e.includes("blank"))).filter((({URI:e})=>!e.includes("default"))).map((({URI:a})=>H(e,a)))));switch(t){case"Disney+":s.some((e=>/\/.+-MAIN\//.test(e)))&&(s=s.filter((e=>/\/.+-MAIN\//.test(e))));break;case"PrimeVideo":s.some((e=>/\/aiv-prod-timedtext\//.test(e)))&&(s=s.filter((e=>/\/aiv-prod-timedtext\//.test(e)))),s=s.filter(((e,a,t)=>t.indexOf(e,0)===a))}return E.log(`✅ Get Subtitle *.vtt *.ttml URLs, subtitles: ${s}`,""),s}(a?.URL,$request.headers,n)),0!==t.length&&(e=e.set(a.URL,t)),E.log("✅ setSubtitlesCache",`val?.URL: ${a?.URL}`,"")}}))),e}function H(e="",a=""){return/^https?:\/\//i.test(a)?a:e.match(/^(https?:\/\/(?:[^?]+)\/)/i)?.[0]+a}E.log(`⚠ FORMAT: ${v}`,""),(async()=>{const e=function(e){console.log("☑️ Detect Platform","");let a=/\.(netflix\.com|nflxvideo\.net)/i.test(e)?"Netflix":/(\.youtube|youtubei\.googleapis)\.com/i.test(e)?"YouTube":/\.spotify(cdn)?\.com/i.test(e)?"Spotify":/\.apple\.com/i.test(e)?"Apple":/\.(dssott|starott)\.com/i.test(e)?"Disney+":/(\.(pv-cdn|aiv-cdn|akamaihd|cloudfront)\.net)|s3\.amazonaws\.com\/aiv-prod-timedtext\//i.test(e)?"PrimeVideo":/prd\.media\.h264\.io/i.test(e)?"Max":/\.(api\.hbo|hbomaxcdn)\.com/i.test(e)?"HBOMax":/\.hulu(stream|im)?\.com/i.test(e)?"Hulu":/\.cbs(aavideo|cbsivideo)?\.com/i.test(e)?"Paramount+":/\.uplynk\.com/i.test(e)?"Discovery+":/dplus-ph-/i.test(e)?"Discovery+Ph":/\.peacocktv\.com/i.test(e)?"PeacockTV":/\.fubo\.tv/i.test(e)?"FuboTV":/\.viki\.io/i.test(e)?"Viki":/epix(hls\.akamaized\.net|\.services\.io)/i.test(e)?"MGM+":/\.nebula\.app/i.test(e)?"Nebula":/\.pluto(\.tv|tv\.net)/i.test(e)?"PlutoTV":/\.mubicdn\.net/i.test(e)?"MUBI":"Universal";return console.log(`✅ Detect Platform, Platform: ${a}`,""),a}($request.url);E.log(`⚠ PLATFORM: ${e}`,"");const{Settings:a,Caches:t,Configs:s}=function(e,a,t,s){console.log("☑️ Set Environment Variables","");let{Settings:n,Caches:l,Configs:g}=e.getENV(a,t,s);if(Array.isArray(n?.Types)||(n.Types=n.Types?[n.Types]:[]),e.isLoon()&&t.includes("YouTube")){switch(n.AutoCC=$persistentStore.read("自动显示翻译字幕")??n.AutoCC,n.AutoCC){case"是":n.AutoCC=!0;break;case"否":n.AutoCC=!1}switch(n.ShowOnly=$persistentStore.read("仅输出译文")??n.ShowOnly,n.ShowOnly){case"是":n.ShowOnly=!0;break;case"否":n.ShowOnly=!1}switch(n.Position=$persistentStore.read("字幕译文位置")??n.Position,n.Position){case"译文位于外文之上":n.Position="Forward";break;case"译文位于外文之下":n.Position="Reverse"}}return console.log(`✅ Set Environment Variables, Settings: ${typeof n}, Settings内容: ${JSON.stringify(n)}`,""),("object"!=typeof l?.Playlists||Array.isArray(l?.Playlists))&&(l.Playlists={}),l.Playlists.Master=new Map(JSON.parse(l?.Playlists?.Master||"[]")),l.Playlists.Subtitle=new Map(JSON.parse(l?.Playlists?.Subtitle||"[]")),"object"!=typeof l?.Subtitles&&(l.Subtitles=new Map(JSON.parse(l?.Subtitles||"[]"))),("object"!=typeof l?.Metadatas||Array.isArray(l?.Metadatas))&&(l.Metadatas={}),"object"!=typeof l?.Metadatas?.Tracks&&(l.Metadatas.Tracks=new Map(JSON.parse(l?.Metadatas?.Tracks||"[]"))),{Settings:n,Caches:l,Configs:g}}(E,"DualSubs",[["YouTube","Netflix","BiliBili","Spotify"].includes(e)?e:"Universal","Composite"],b);switch(E.log(`⚠ Settings.Switch: ${a?.Switch}`,""),a.Switch){case!0:default:const n=$.query?.subtype??a.Type,l=[$.query?.lang?.toUpperCase?.()??a.Languages[0],($.query?.tlang??t?.tlang)?.toUpperCase?.()??a.Languages[1]];E.log(`⚠ Type: ${n}, Languages: ${l}`,"");const{standard:g,device:u}=function(e={},a={},t="Universal"){console.log("☑️ is Standard?","");const s=a["user-agent"]??a["User-Agent"];console.log(`🚧 is Standard?, UA: ${s}`,"");let n=s.includes("Mozilla/5.0")?"Web":s.includes("iPhone")?"iPhone":s.includes("iPad")?"iPad":s.includes("Macintosh")?"Macintosh":s.includes("AppleTV")||s.includes("Apple TV")?"AppleTV":"iPhone";switch(t){case"Max":case"HBOMax":(a["x-hbo-device-name"]?.includes("ios")||"iphone"===e.query?.["device-code"])&&(n="iPhone");break;case"PeacockTV":s.includes("PeacockMobile")&&(n="iPhone")}let l=!0;switch(n){case"iPhone":case"iPad":case"Macintosh":switch(t){case"Max":case"HBOMax":case"Viki":case"PeacockTV":case"FuboTV":case"MUBI":l=!1;break;default:l=!0}break;case"Web":switch(t){case"Max":case"HBOMax":case"FuboTV":case"TED":case"MUBI":l=!1;break;default:l=!0}break;default:l=!0}return console.log(`✅ is Standard?, standard: ${l}, device: ${n}`,""),{standard:l,device:n}}($,$request.headers,e);let o={};switch(v){case void 0:case"application/x-www-form-urlencoded":case"text/plain":case"text/html":default:break;case"application/x-mpegURL":case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"audio/mpegurl":switch(o=A.parse($response.body),function(e={}){let a;return console.log("☑️ detectPlaylist",""),e.forEach((e=>{switch(e.TAG){case"#EXT-X-MEDIA":case"#EXT-X-STREAM-INF":a="Multivariant Playlist";break;case"#EXT-X-PLAYLIST-TYPE":case"EXT-X-TARGETDURATION":case"#EXTINF":a="Media Playlist"}})),console.log(`✅ detectPlaylist, type: ${a}`,""),a}(o)){case"Multivariant Playlist":let i=t.Playlists.Master.get($request.url)||{};i[l[0]]=I($request.url,o,"SUBTITLES",s.Languages[l[0]]),i[l[1]]=I($request.url,o,"SUBTITLES",s.Languages[l[1]]),t.Playlists.Master.set($request.url,i),t.Playlists.Master=O(t.Playlists.Master,a.CacheSize),E.setjson(t.Playlists.Master,"@DualSubs.Composite.Caches.Playlists.Master"),o=function(e={},a={},t=[],s=[],n="",l=!0,g="iPhone"){t=1==l?t:[t.at(-1)];const u=a?.[s?.[0]],o=a?.[s?.[1]];return E.log("☑️ Set Attribute List",`types: ${t}`,""),u?.forEach((a=>{const u=e.findIndex((e=>e?.OPTION?.URI===a.OPTION.URI));t.forEach((t=>{E.log(`🚧 Set Attribute List, type: ${t}`,"");let i={};switch(t){case"Official":o?.forEach((e=>{if(a?.OPTION?.["GROUP-ID"]===e?.OPTION?.["GROUP-ID"])if("Apple"===n)a?.OPTION.CHARACTERISTICS==e?.OPTION.CHARACTERISTICS&&(i=P(a,e,t,n,l,g));else i=P(a,e,t,n,l,g)}));break;case"Translate":case"External":const e={OPTION:{TYPE:"SUBTITLES",NAME:o?.[0]?.OPTION?.NAME??s[1].toLowerCase(),LANGUAGE:o?.[0]?.OPTION?.LANGUAGE??s[1].toLowerCase()}};i=P(a,e,t,n,l,g),i.OPTION.URI+=`&lang=${a?.OPTION?.LANGUAGE?.toUpperCase()}`}0!==Object.keys(i).length&&(l?e.splice(u+1,0,i):e.splice(u,1,i))}))})),E.log("✅ Set Attribute List",""),e}(o,i,a.Types,l,e,g,u);break;case"Media Playlist":switch(n){case"Official":E.log("⚠ 官方字幕","");const{subtitlesPlaylist:s,subtitlesPlaylistIndex:n}=U($request.url,t.Playlists.Master,l[0])??U($request.url,t.Playlists.Master,l[1]);t.Playlists.Subtitle=await L(t.Playlists.Subtitle,s,l[0],n,e),t.Playlists.Subtitle=await L(t.Playlists.Subtitle,s,l[1],n,e),t.Playlists.Subtitle=O(t?.Playlists.Subtitle,a.CacheSize),E.setjson(t.Playlists.Subtitle,"@DualSubs.Composite.Caches.Playlists.Subtitle");break;case"Translate":default:E.log("⚠ 翻译字幕","");break;case"External":E.log("⚠ 外挂字幕","")}o=o.map(((e,a)=>{if(/^.+\.((web)?vtt|ttml2?|xml|smi)(\?.+)?$/.test(e?.URI)){const a=e.URI.includes("?")?"&":"?";/empty|blank|default/.test(e.URI)||($.query?.lang?e.URI+=`${a}subtype=${n}&lang=${$.query.lang}`:e.URI+=`${a}subtype=${n}`)}if("#EXT-X-BYTERANGE"!==e.TAG)return e;o[a-1].URI=e.URI}))}$response.body=A.stringify(o)}case!1:}})().catch((e=>E.logErr(e))).finally((()=>{if(void 0!==$response)if(E.log("🎉 finally","$response",`FORMAT: ${v}`,""),$response?.headers?.["Content-Encoding"]&&($response.headers["Content-Encoding"]="identity"),$response?.headers?.["content-encoding"]&&($response.headers["content-encoding"]="identity"),E.isQuanX())switch(v){case void 0:E.done({status:$response.status,headers:$response.headers});break;default:E.done({status:$response.status,headers:$response.headers,body:$response.body});break;case"application/protobuf":case"application/x-protobuf":case"application/vnd.google.protobuf":case"application/grpc":case"application/grpc+proto":case"application/octet-stream":E.done({status:$response.status,headers:$response.headers,bodyBytes:$response.bodyBytes.buffer.slice($response.bodyBytes.byteOffset,$response.bodyBytes.byteLength+$response.bodyBytes.byteOffset)})}else E.done($response)}));
